{"version":3,"file":"index.umd.js","sources":["../src/useForm.js","../src/remember.js","../src/app.js","../src/head.js","../src/link.js","../src/createInertiaApp.js","../src/useRemember.js"],"sourcesContent":["import isEqual from 'lodash.isequal'\nimport { reactive, watch } from 'vue'\nimport cloneDeep from 'lodash.clonedeep'\nimport { Inertia } from '@inertiajs/inertia'\n\nexport default function useForm(...args) {\n  const rememberKey = typeof args[0] === 'string' ? args[0] : null\n  const data = (typeof args[0] === 'string' ? args[1] : args[0]) || {}\n  const restored = rememberKey ? Inertia.restore(rememberKey) : null\n  let defaults = cloneDeep(data)\n  let cancelToken = null\n  let recentlySuccessfulTimeoutId = null\n  let transform = data => data\n\n  let form = reactive({\n    ...restored ? restored.data : data,\n    isDirty: false,\n    errors: restored ? restored.errors : {},\n    hasErrors: false,\n    processing: false,\n    progress: null,\n    wasSuccessful: false,\n    recentlySuccessful: false,\n    data() {\n      return Object\n        .keys(data)\n        .reduce((carry, key) => {\n          carry[key] = this[key]\n          return carry\n        }, {})\n    },\n    transform(callback) {\n      transform = callback\n\n      return this\n    },\n    reset(...fields) {\n      let clonedDefaults = cloneDeep(defaults)\n      if (fields.length === 0) {\n        Object.assign(this, clonedDefaults)\n      } else {\n        Object.assign(\n          this,\n          Object\n            .keys(clonedDefaults)\n            .filter(key => fields.includes(key))\n            .reduce((carry, key) => {\n              carry[key] = clonedDefaults[key]\n              return carry\n            }, {}),\n        )\n      }\n\n      return this\n    },\n    clearErrors(...fields) {\n      this.errors = Object\n        .keys(this.errors)\n        .reduce((carry, field) => ({\n          ...carry,\n          ...(fields.length > 0 && !fields.includes(field) ? { [field] : this.errors[field] } : {}),\n        }), {})\n\n      this.hasErrors = Object.keys(this.errors).length > 0\n\n      return this\n    },\n    submit(method, url, options = {}) {\n      const data = transform(this.data())\n      const _options = {\n        ...options,\n        onCancelToken: (token) => {\n          cancelToken = token\n\n          if (options.onCancelToken) {\n            return options.onCancelToken(token)\n          }\n        },\n        onBefore: visit => {\n          this.wasSuccessful = false\n          this.recentlySuccessful = false\n          clearTimeout(recentlySuccessfulTimeoutId)\n\n          if (options.onBefore) {\n            return options.onBefore(visit)\n          }\n        },\n        onStart: visit => {\n          this.processing = true\n\n          if (options.onStart) {\n            return options.onStart(visit)\n          }\n        },\n        onProgress: event => {\n          this.progress = event\n\n          if (options.onProgress) {\n            return options.onProgress(event)\n          }\n        },\n        onSuccess: async page => {\n          this.processing = false\n          this.progress = null\n          this.clearErrors()\n          this.wasSuccessful = true\n          this.recentlySuccessful = true\n          recentlySuccessfulTimeoutId = setTimeout(() => this.recentlySuccessful = false, 2000)\n\n          const onSuccess = options.onSuccess ? await options.onSuccess(page) : null\n          defaults = cloneDeep(this.data())\n          this.isDirty = false\n          return onSuccess\n        },\n        onError: errors => {\n          this.processing = false\n          this.progress = null\n          this.errors = errors\n          this.hasErrors = true\n\n          if (options.onError) {\n            return options.onError(errors)\n          }\n        },\n        onCancel: () => {\n          this.processing = false\n          this.progress = null\n\n          if (options.onCancel) {\n            return options.onCancel()\n          }\n        },\n        onFinish: () => {\n          this.processing = false\n          this.progress = null\n          cancelToken = null\n\n          if (options.onFinish) {\n            return options.onFinish()\n          }\n        },\n      }\n\n      if (method === 'delete') {\n        Inertia.delete(url, { ..._options, data  })\n      } else {\n        Inertia[method](url, data, _options)\n      }\n    },\n    get(url, options) {\n      this.submit('get', url, options)\n    },\n    post(url, options) {\n      this.submit('post', url, options)\n    },\n    put(url, options) {\n      this.submit('put', url, options)\n    },\n    patch(url, options) {\n      this.submit('patch', url, options)\n    },\n    delete(url, options) {\n      this.submit('delete', url, options)\n    },\n    cancel() {\n      if (cancelToken) {\n        cancelToken.cancel()\n      }\n    },\n    __rememberable: rememberKey === null,\n    __remember() {\n      return { data: this.data(), errors: this.errors }\n    },\n    __restore(restored) {\n      Object.assign(this, restored.data)\n      Object.assign(this.errors, restored.errors)\n      this.hasErrors = Object.keys(this.errors).length > 0\n    },\n  })\n\n  watch(form, newValue => {\n    form.isDirty = !isEqual(form.data(), defaults)\n    if (rememberKey) {\n      Inertia.remember(cloneDeep(newValue.__remember()), rememberKey)\n    }\n  }, { immediate: true, deep: true })\n\n  return form\n}\n","import cloneDeep from 'lodash.clonedeep'\nimport { Inertia } from '@inertiajs/inertia'\n\nexport default {\n  created() {\n    if (!this.$options.remember) {\n      return\n    }\n\n    if (Array.isArray(this.$options.remember)) {\n      this.$options.remember = { data: this.$options.remember }\n    }\n\n    if (typeof this.$options.remember === 'string') {\n      this.$options.remember = { data: [this.$options.remember] }\n    }\n\n    if (typeof this.$options.remember.data === 'string') {\n      this.$options.remember = { data: [this.$options.remember.data] }\n    }\n\n    const rememberKey = this.$options.remember.key instanceof Function\n      ? this.$options.remember.key.call(this)\n      : this.$options.remember.key\n\n    const restored = Inertia.restore(rememberKey)\n\n    const rememberable = this.$options.remember.data.filter(key => {\n      return !(this[key] !== null && typeof this[key] === 'object' && this[key].__rememberable === false)\n    })\n\n    const hasCallbacks = (key) => {\n      return this[key] !== null\n        && typeof this[key] === 'object'\n        && typeof this[key].__remember === 'function'\n        && typeof this[key].__restore === 'function'\n    }\n\n    rememberable.forEach(key => {\n      if (this[key] !== undefined && restored !== undefined && restored[key] !== undefined) {\n        hasCallbacks(key) ? this[key].__restore(restored[key]) : (this[key] = restored[key])\n      }\n\n      this.$watch(key, () => {\n        Inertia.remember(\n          rememberable.reduce((data, key) => ({\n            ...data,\n            [key]: cloneDeep(hasCallbacks(key) ? this[key].__remember(): this[key]),\n          }), {}),\n          rememberKey,\n        )\n      }, { immediate: true, deep: true })\n    })\n  },\n}\n","import useForm from './useForm'\nimport remember from './remember'\nimport { computed, h, markRaw, ref, nextTick } from 'vue'\nimport { createHeadManager, Inertia } from '@inertiajs/inertia'\nimport cloneDeep from 'lodash.clonedeep'\n\nconst page = ref({})\nconst pageKey = ref(null)\nconst pageComponent = ref(null)\n\nconst dialog = ref({})\nconst dialogKey = ref(null)\nconst dialogComponent = ref(null)\nlet headManager = null\n\nexport default {\n  name: 'Inertia',\n  props: {\n    initialPage: {\n      type: Object,\n      required: true,\n    },\n    initialComponent: {\n      type: Object,\n      required: false,\n    },\n    resolveComponent: {\n      type: Function,\n      required: false,\n    },\n    titleCallback: {\n      type: Function,\n      required: false,\n      default: title => title,\n    },\n    onHeadUpdate: {\n      type: Function,\n      required: false,\n      default: () => () => {},\n    },\n  },\n  setup({ initialPage, initialComponent, resolveComponent, titleCallback, onHeadUpdate }) {\n    pageComponent.value = initialComponent ? markRaw(initialComponent) : null\n    pageKey.value = null\n    page.value = initialPage\n\n    const isServer = typeof window === 'undefined'\n    headManager = createHeadManager(isServer, titleCallback, onHeadUpdate)\n\n    if (!isServer) {\n      Inertia.init({\n        initialPage,\n        resolveComponent,\n        swapComponent: async (args) => {\n          const { dialog: _dialog, ..._page } = args.page\n\n          page.value = _page\n          pageKey.value = (args.preserveState || args.dialogComponent) ? pageKey.value : Date.now()\n          pageComponent.value = markRaw(args.component)\n\n          if (args.dialogComponent) {\n            nextTick(() => {\n              function shouldAppear() {\n                const newKey = [args.dialogComponent, ...Object.values(args.dialogComponent.components)].find(component => component.dialogKey)?.dialogKey\n                const currentKey = [dialogComponent.value || {}, ...Object.values(dialogComponent.value?.components || {})].find(component => component.dialogKey)?.dialogKey\n\n                return !_dialog.eager &&\n                    !(dialog.value.open &&\n                      (_dialog.component === dialog.value.component || (newKey && currentKey && newKey === currentKey))\n                    )\n              }\n\n              dialog.value = { ...cloneDeep(_dialog), open: true, appear: shouldAppear() }\n              dialogKey.value = (args.preserveState && args.dialogComponent) ? dialogKey.value : Date.now()\n              dialogComponent.value = markRaw(args.dialogComponent)\n            })\n          } else if (dialog.value.open === true) {\n            dialog.value.open = false\n          }\n        },\n      })\n    }\n\n    function renderPage() {\n      pageComponent.value.inheritAttrs = !!pageComponent.value.inheritAttrs\n\n      return h(pageComponent.value, {\n        ...page.value.props,\n        dialog: false,\n        key: pageKey.value,\n      })\n    }\n\n    function renderLayout(child) {\n      if (typeof pageComponent.value.layout === 'function') {\n        return pageComponent.value.layout(h, child)\n      } else if (Array.isArray(pageComponent.value.layout)) {\n        return pageComponent.value.layout\n          .concat(child)\n          .reverse()\n          .reduce((child, layout) => {\n            layout.inheritAttrs = !!layout.inheritAttrs\n            return h(layout, { ...page.value.props }, () => child)\n          })\n      }\n\n      return [\n        h(pageComponent.value.layout, { ...page.value.props }, () => child),\n        renderDialog(),\n      ]\n    }\n\n    function renderDialog() {\n      return dialogComponent.value ? h(dialogComponent.value, {\n        ...dialog.value.props,\n        key: dialogKey.value,\n      }) : null\n    }\n\n    return () => {\n      if (pageComponent.value) {\n        const page = renderPage()\n\n        if (pageComponent.value.layout) {\n          return renderLayout(page)\n        }\n\n        return [page, renderDialog()]\n      }\n    }\n  },\n}\n\nexport const plugin = {\n  install(app) {\n    Inertia.form = useForm\n\n    Object.defineProperty(app.config.globalProperties, '$inertia', { get: () => Inertia })\n    Object.defineProperty(app.config.globalProperties, '$page', { get: () => page.value })\n    Object.defineProperty(app.config.globalProperties, '$dialog', { get: () => dialog.value })\n    Object.defineProperty(app.config.globalProperties, '$headManager', { get: () => headManager })\n\n    app.mixin(remember)\n  },\n}\n\nexport function usePage() {\n  return {\n    props: computed(() => page.value.props),\n    url: computed(() => page.value.url),\n    component: computed(() => page.value.component),\n    version: computed(() => page.value.version),\n  }\n}\n","export default {\n  props: {\n    title: {\n      type: String,\n      required: false,\n    },\n  },\n  data() {\n    return {\n      provider: this.$headManager.createProvider(),\n    }\n  },\n  beforeUnmount() {\n    this.provider.disconnect()\n  },\n  methods: {\n    isUnaryTag(node) {\n      return [\n        'area', 'base', 'br', 'col', 'embed', 'hr', 'img',\n        'input', 'keygen', 'link', 'meta', 'param', 'source',\n        'track', 'wbr',\n      ].indexOf(node.type) > -1\n    },\n    renderTagStart(node) {\n      node.props = node.props || {}\n      node.props.inertia = node.props['head-key'] !== undefined ? node.props['head-key'] : ''\n      const attrs = Object.keys(node.props).reduce((carry, name) => {\n        const value = node.props[name]\n        if (['key', 'head-key'].includes(name)) {\n          return carry\n        } else if (value === '') {\n          return carry + ` ${name}`\n        } else {\n          return carry + ` ${name}=\"${value}\"`\n        }\n      }, '')\n      return `<${node.type}${attrs}>`\n    },\n    renderTagChildren(node) {\n      return typeof node.children === 'string'\n        ? node.children\n        : node.children.reduce((html, child) => html + this.renderTag(child), '')\n    },\n    renderTag(node) {\n      if (node.type.toString() === 'Symbol(Text)') {\n        return node.children\n      } else if (node.type.toString() === 'Symbol()') {\n        return ''\n      } else if (node.type.toString() === 'Symbol(Comment)') {\n        return ''\n      }\n      let html = this.renderTagStart(node)\n      if (node.children) {\n        html += this.renderTagChildren(node)\n      }\n      if (!this.isUnaryTag(node)) {\n        html += `</${node.type}>`\n      }\n      return html\n    },\n    addTitleElement(elements) {\n      if (this.title && !elements.find(tag => tag.startsWith('<title'))) {\n        elements.push(`<title inertia>${this.title}</title>`)\n      }\n      return elements\n    },\n    renderNodes(nodes) {\n      return this.addTitleElement(\n        nodes\n          .flatMap(node => node.type.toString() === 'Symbol(Fragment)' ? node.children : node)\n          .map(node => this.renderTag(node))\n          .filter(node => node)\n      )\n    },\n  },\n  render() {\n    this.provider.update(\n      this.renderNodes(this.$slots.default ? this.$slots.default() : [])\n    )\n  },\n}\n","import { h } from 'vue'\nimport { Inertia, mergeDataIntoQueryString, shouldIntercept } from '@inertiajs/inertia'\n\nexport default {\n  name: 'InertiaLink',\n  props: {\n    as: {\n      type: String,\n      default: 'a',\n    },\n    data: {\n      type: Object,\n      default: () => ({}),\n    },\n    href: {\n      type: String,\n      required: true,\n    },\n    method: {\n      type: String,\n      default: 'get',\n    },\n    replace: {\n      type: Boolean,\n      default: false,\n    },\n    preserveScroll: {\n      type: Boolean,\n      default: false,\n    },\n    preserveState: {\n      type: Boolean,\n      default: null,\n    },\n    only: {\n      type: Array,\n      default: () => [],\n    },\n    headers: {\n      type: Object,\n      default: () => ({}),\n    },\n  },\n  setup(props, { slots, attrs }) {\n    return props => {\n      const as = props.as.toLowerCase()\n      const method = props.method.toLowerCase()\n      const [href, data] = mergeDataIntoQueryString(method, props.href, props.data)\n\n      if (as === 'a' && method !== 'get') {\n        console.warn(`Creating POST/PUT/PATCH/DELETE <a> links is discouraged as it causes \"Open Link in New Tab/Window\" accessibility issues.\\n\\nPlease specify a more appropriate element using the \"as\" attribute. For example:\\n\\n<inertia-link href=\"${href}\" method=\"${method}\" as=\"button\">...</inertia-link>`)\n      }\n\n      return h(props.as, {\n        ...attrs,\n        ...as === 'a' ? { href } : {},\n        onClick: (event) => {\n          if (shouldIntercept(event)) {\n            event.preventDefault()\n\n            Inertia.visit(href, {\n              data: data,\n              method: method,\n              replace: props.replace,\n              preserveScroll: props.preserveScroll,\n              preserveState: props.preserveState ?? (method !== 'get'),\n              only: props.only,\n              headers: props.headers,\n              onCancelToken: attrs.onCancelToken || (() => ({})),\n              onBefore: attrs.onBefore || (() => ({})),\n              onStart: attrs.onStart || (() => ({})),\n              onProgress: attrs.onProgress || (() => ({})),\n              onFinish: attrs.onFinish || (() => ({})),\n              onCancel: attrs.onCancel || (() => ({})),\n              onSuccess: attrs.onSuccess || (() => ({})),\n              onError: attrs.onError || (() => ({})),\n            })\n          }\n        },\n      }, slots)\n    }\n  },\n}\n","import { createSSRApp, h } from 'vue'\nimport App, { plugin } from './app'\n\nexport default async function createInertiaApp({ id = 'app', resolve, setup, title, page, render }) {\n  const isServer = typeof window === 'undefined'\n  const el = isServer ? null : document.getElementById(id)\n  const initialPage = page || JSON.parse(el.dataset.page)\n  const resolveComponent = name => Promise.resolve(resolve(name)).then(module => module.default || module)\n\n  let head = []\n\n  const vueApp = await resolveComponent(initialPage.component).then(initialComponent => {\n    return setup({\n      el,\n      app: App, // deprecated\n      App,\n      props: {\n        initialPage,\n        initialComponent,\n        resolveComponent,\n        titleCallback: title,\n        onHeadUpdate: isServer ? elements => (head = elements) : null,\n      },\n      plugin,\n    })\n  })\n\n  if (isServer) {\n    const body = await render(createSSRApp({\n      render: () => h('div', {\n        id,\n        'data-page': JSON.stringify(initialPage),\n        innerHTML: render(vueApp),\n      }),\n    }))\n\n    return { head, body }\n  }\n}\n","import cloneDeep from 'lodash.clonedeep'\nimport { Inertia } from '@inertiajs/inertia'\nimport { isReactive, reactive, ref, watch } from 'vue'\n\nexport default function useRemember(data, key) {\n  if (typeof data === 'object' && data !== null && data.__rememberable === false) {\n    return data\n  }\n\n  const restored = Inertia.restore(key)\n  const type = isReactive(data) ? reactive : ref\n  const hasCallbacks = typeof data.__remember === 'function' && typeof data.__restore === 'function'\n  const remembered = restored === undefined ? data : type(hasCallbacks ? data.__restore(restored) : restored)\n\n  watch(remembered, (newValue) => {\n    Inertia.remember(cloneDeep(hasCallbacks ? data.__remember() : newValue), key)\n  }, { immediate: true, deep: true })\n\n  return remembered\n}\n"],"names":["useForm","args","rememberKey","data","restored","Inertia","restore","defaults","cloneDeep","cancelToken","recentlySuccessfulTimeoutId","transform","form","reactive","isDirty","errors","hasErrors","processing","progress","wasSuccessful","recentlySuccessful","Object","keys","reduce","carry","key","_this","callback","reset","fields","clonedDefaults","assign","this","length","filter","includes","clearErrors","field","_this2","submit","method","url","options","_options","onCancelToken","token","onBefore","visit","_this3","clearTimeout","onStart","onProgress","event","onSuccess","page","_this4","setTimeout","onError","onCancel","onFinish","get","post","put","patch","cancel","__rememberable","__remember","__restore","watch","newValue","isEqual","remember","immediate","deep","created","$options","Array","isArray","Function","call","rememberable","hasCallbacks","forEach","undefined","$watch","ref","pageKey","pageComponent","dialog","dialogKey","dialogComponent","headManager","name","props","initialPage","type","required","initialComponent","resolveComponent","titleCallback","default","title","onHeadUpdate","setup","value","markRaw","isServer","window","renderDialog","h","createHeadManager","init","swapComponent","_dialog","_page","preserveState","Date","now","component","nextTick","newKey","currentKey","open","appear","values","components","find","_find","_find2","eager","inheritAttrs","layout","child","concat","reverse","plugin","install","app","defineProperty","config","globalProperties","mixin","String","provider","$headManager","createProvider","beforeUnmount","disconnect","methods","isUnaryTag","node","indexOf","renderTagStart","inertia","attrs","renderTagChildren","children","html","renderTag","toString","addTitleElement","elements","tag","startsWith","push","renderNodes","nodes","flatMap","map","render","update","$slots","as","href","replace","Boolean","preserveScroll","only","headers","slots","toLowerCase","mergeDataIntoQueryString","console","warn","onClick","shouldIntercept","preventDefault","id","resolve","el","document","getElementById","JSON","parse","dataset","Promise","then","module","head","App","vueApp","createSSRApp","data-page","stringify","innerHTML","body","computed","version","isReactive","remembered"],"mappings":"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"}